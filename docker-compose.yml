version: '3'

services:

    memcached: # to connect use: docker exec -it centos-memcached bash
        container_name: 'centos-memcached'
        image: 'khalifahks/centos-memcached'
        networks:
            net_1:
                aliases: # assigns a hostname to the container.
                    - 'wen_memcached'
        ports:
            - '11211:11211'

    nginx: # to connect use: docker exec -it centos-nginx bash
        container_name: 'centos-nginx'
        image: 'khalifahks/centos-nginx'
        depends_on:
            - 'apps' # Because NginX configs will point to this container.
            - 'apps54' # Because NginX configs will point to this container.
        networks:
            net_1:
                aliases:
                    - 'wen_nginx'
        ports:
            - '80:80'
            - '443:443'
        volumes:
            - "${NGINX_CONFS_DIR}:/etc/nginx/conf-docker.d"
            - "${APPS_DIR}:${DOCKER_APPS_DIR}"
            - "${SSL_DIR}:/etc/ssl/nginx"
        env_file:
            - './apps.env'

    mongodb: # to connect use: docker exec -it centos-mysql bash
        container_name: 'centos-mongodb'
        image: 'khalifahks/centos-mongodb'
        networks:
            net_1:
                aliases:
                    - 'web_mongodb'
        ports:
            - '27017:27017'
        volumes:
            - mongoData:/var/lib/mongo
            - mongoLog:/var/log/mongodb

   # This is the docker container to login to and build your apps.
    apps: # to connect use: docker exec -it centos-apps bash
        container_name: 'centos-apps'
        image: 'khalifahks/centos-apps'
        networks:
            net_1:
                aliases:
                    - 'wen_apps'
        volumes:
            - "${APPS_DIR}:${DOCKER_APPS_DIR}"
        ports:
            - '9000:9000'
            - '10000:10000'
        env_file:
            - './apps.env'
        environment:
            XDEBUG_CONFIG: "remote_host=${HOST_IP}"
            DBGP_IDEKEY:
            NODE_ENV: 'development'

    # This is the docker container to login to and build your apps.
    apps54: # to connect use: docker exec -it centos-apps bash
        container_name: 'centos-apps54'
        image: 'khalifahks/centos-apps:54'
        networks:
            net_1:
                aliases:
                    - 'wen_apps54'
        volumes:
            - "${APPS_DIR}:${DOCKER_APPS_DIR}"
        ports:
            - '9054:9000'
            - '10054:10000'
        env_file:
            - './apps.env'
        environment:
            XDEBUG_CONFIG: "remote_host=${HOST_IP}"
            DBGP_IDEKEY:
            NODE_ENV: 'development'

networks:
    net_1:

volumes:
    mongoData:
        external: true
    mongoLog:
        external: true